!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var t=r();for(var n in t)("object"==typeof exports?exports:e)[n]=t[n]}}(global,function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var i in e)t.d(n,i,function(r){return e[r]}.bind(null,i));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=1)}([function(e,r){e.exports=require("bs58check")},function(e,r,t){t(2),e.exports=t(3)},function(e,r){e.exports=require("@babel/polyfill")},function(e,r,t){function n(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(t.push(a.value),!r||t.length!==r);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw o}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e,r,t,n,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void t(e)}c.done?r(s):Promise.resolve(s).then(n,i)}function a(e){return function(){var r=this,t=arguments;return new Promise(function(n,i){var a=e.apply(r,t);function c(e){o(a,n,i,c,s,"next",e)}function s(e){o(a,n,i,c,s,"throw",e)}c(void 0)})}}var c=t(4),s=t(0),u=t(5),d=t(6),f=t(7),p=t(8),l=t(9).default,h=t(10).default,g={},v={tz1:new Uint8Array([6,161,159]),tz2:new Uint8Array([6,161,161]),tz3:new Uint8Array([6,161,164]),KT:new Uint8Array([2,90,121]),edpk:new Uint8Array([13,15,37,217]),edsk2:new Uint8Array([13,15,58,7]),spsk:new Uint8Array([17,162,224,201]),p2sk:new Uint8Array([16,81,238,189]),sppk:new Uint8Array([3,254,226,86]),p2pk:new Uint8Array([3,178,139,127]),edesk:new Uint8Array([7,90,60,179,41]),edsk:new Uint8Array([43,246,78,7]),edsig:new Uint8Array([9,245,205,134,18]),spsig1:new Uint8Array([13,115,101,19,63]),p2sig:new Uint8Array([54,240,44,52]),sig:new Uint8Array([4,130,43]),Net:new Uint8Array([87,82,0]),nce:new Uint8Array([69,220,169]),b:new Uint8Array([1,52]),o:new Uint8Array([5,116]),Lo:new Uint8Array([133,233]),LLo:new Uint8Array([29,159,109]),P:new Uint8Array([2,170]),Co:new Uint8Array([79,179]),id:new Uint8Array([153,103])},m={block:new Uint8Array([1]),endorsement:new Uint8Array([2]),generic:new Uint8Array([3])},y={b582int:function(e){for(var r=new p(0),t="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",n=0;n<e.length;n++)r=r.plus(new p(t.indexOf(e[e.length-1-n]).multipliedBy(new p(t.length).exponentiatedBy(n))));return r.toString(16)},totez:function(e){return parseInt(e,10)/1e6},mutez:function(e){return new p(new p(e).toFixed(6)).multipliedBy(1e6).toString()},b58cencode:function(e,r){var t=new Uint8Array(r.length+e.length);return t.set(r),t.set(e,r.length),s.encode(Buffer.from(t,"hex"))},b58cdecode:function(e,r){return s.decode(e).slice(r.length)},buf2hex:function(e){var r=new Uint8Array(e),t=[];return r.forEach(function(e){var r=e.toString(16),n="00".concat(r).slice(-2);t.push(n)}),t.join("")},hex2buf:function(e){return new Uint8Array(e.match(/[\da-f]{2}/gi).map(function(e){return parseInt(e,16)}))},hexNonce:function(e){for(var r="";e--;)r+="0123456789abcedf"[16*Math.random()|0];return r},mergebuf:function(e,r){var t=new Uint8Array(e.length+r.length);return t.set(e),t.set(r,e.length),t},sexp2mic:function e(r){"("===(r=r.replace(/(?:@[a-z_]+)|(?:#.*$)/gm,"").replace(/\s+/g," ").trim()).charAt(0)&&(r=r.slice(1,-1));for(var t=0,n=!1,i=!1,o={prim:"",args:[]},a="",c=0;c<r.length;c++)if(i)a+=r[c],i=!1;else if(c===r.length-1&&!1===n||" "===r[c]&&0===t&&!1===n){if(c===r.length-1&&(a+=r[c]),a){if(a===parseInt(a,10).toString()){if(!o.prim)return{int:a};o.args.push({int:a})}else if("0"===a[0]){if(!o.prim)return{bytes:a};o.args.push({bytes:a})}else o.prim?o.args.push(e(a)):o.prim=a;a=""}}else if('"'===r[c]&&n){if(n=!1,!o.prim)return{string:a};o.args.push({string:a}),a=""}else'"'!==r[c]||n||0!==t?("\\"===r[c]?i=!0:"("===r[c]?t++:")"===r[c]&&t--,a+=r[c]):n=!0;return o},mic2arr:function e(r){var t=[];if(Object.prototype.hasOwnProperty.call(r,"prim"))"Pair"===r.prim?(t.push(e(r.args[0])),t=t.concat(e(r.args[1]))):"Elt"===r.prim?t={key:e(r.args[0]),val:e(r.args[1])}:"True"===r.prim?t=!0:"False"===r.prim&&(t=!1);else if(Array.isArray(r))for(var n=r.length,i=0;i<n;i++){var o=e(r[i]);void 0!==o.key?(Array.isArray(t)&&(t={keys:[],vals:[]}),t.keys.push(o.key),t.vals.push(o.val)):t.push(o)}else t=Object.prototype.hasOwnProperty.call(r,"string")?r.string:Object.prototype.hasOwnProperty.call(r,"int")?parseInt(r.int,10):r;return t},ml2mic:function e(r){for(var t=[],n=!1,i="",o="",a=0,c=0,s=!1,u=!1,d=0;d<r.length;d++){if("}"!==o&&";"!==o||(o=""),n){if("}"===r[d]?c--:"{"===r[d]&&c++,0===c){var f=e(o);t.push({prim:i.trim(),args:[f]}),o="",c=0,n=!1}}else{if("{"===r[d]){c++,i=o,o="",n=!0;continue}if(u){o+=r[d],u=!1;continue}if(d===r.length-1&&!1===s||";"===r[d]&&0===a&&!1===s){if(d===r.length-1&&(o+=r[d]),""===o.trim()||"}"===o.trim()||";"===o.trim()){o="";continue}t.push(y.ml2tzjson(o)),o="";continue}'"'===r[d]&&s?s=!1:'"'!==r[d]||s?"\\"===r[d]?u=!0:"("===r[d]?a++:")"===r[d]&&a--:s=!0}o+=r[d]}return t},formatMoney:function(e,r,t,n){var i=isNaN(r=Math.abs(r))?2:r,o=void 0===t?".":t,a=void 0===n?",":n,c=e<0?"-":"",s=String(parseInt(e=Math.abs(Number(e)||0).toFixed(i),10)),u=s.length>3?s.length%3:0;return c+(u?s.substr(0,u)+a:"")+s.substr(u).replace(/(\d{3})(?=\d)/g,"$1".concat(a))+(i?o+Math.abs(e-s).toFixed(r).slice(2):"")}},b={extractKeys:function(e){switch(e.substr(0,4)){case"edsk":if(98===e.length)return{pk:y.b58cencode(y.b58cdecode(e,v.edsk).slice(32),v.edpk),pkh:y.b58cencode(u.crypto_generichash(20,y.b58cdecode(e,v.edsk).slice(32)),v.tz1),sk:e};if(54===e.length){var r=y.b58cdecode(e,v.edsk2),t=u.crypto_sign_seed_keypair(r);return{sk:y.b58cencode(t.privateKey,v.edsk),pk:y.b58cencode(t.publicKey,v.edpk),pkh:y.b58cencode(u.crypto_generichash(20,t.publicKey),v.tz1)}}break;default:return!1}},generateMnemonic:function(){return d.generateMnemonic(160)},checkAddress:function(e){try{return y.b58cdecode(e,v.tz1),!0}catch(e){return!1}},generateKeysNoSeed:function(){var e=u.crypto_sign_keypair();return{sk:y.b58cencode(e.privateKey,v.edsk),pk:y.b58cencode(e.publicKey,v.edpk),pkh:y.b58cencode(u.crypto_generichash(20,e.publicKey),v.tz1)}},generateKeys:function(e,r){var t=d.mnemonicToSeed(e,r).slice(0,32),n=u.crypto_sign_seed_keypair(t);return{mnemonic:e,passphrase:r,sk:y.b58cencode(n.privateKey,v.edsk),pk:y.b58cencode(n.publicKey,v.edpk),pkh:y.b58cencode(u.crypto_generichash(20,n.publicKey),v.tz1)}},generateKeysFromSeedMulti:function(e,r,t){t/=258;var n=d.mnemonicToSeed(e,f.pbkdf2Sync(r,t.toString(36).slice(2),0,32,"sha512").toString()).slice(0,32),i=u.crypto_sign_seed_keypair(n);return{mnemonic:e,passphrase:r,n:t,sk:y.b58cencode(i.privateKey,v.edsk),pk:y.b58cencode(i.publicKey,v.edpk),pkh:y.b58cencode(u.crypto_generichash(20,i.publicKey),v.tz1)}},sign:function(e,r,t){var n=y.hex2buf(e);void 0!==t&&(n=y.mergebuf(t,n));var i=u.crypto_sign_detached(u.crypto_generichash(32,n),y.b58cdecode(r,v.edsk),"uint8array");return{bytes:e,sig:i,edsig:y.b58cencode(i,v.edsig),sbytes:e+y.buf2hex(i)}},verify:function(e,r,t){return u.crypto_sign_verify_detached(r,y.hex2buf(e),y.b58cdecode(t,v.edpk))}},k={activeProvider:"http://127.0.0.1:8732",debugMode:!1,async:!0,isZeronet:!1,setDebugMode:function(e){k.debugMode=e},setProvider:function(e,r){void 0!==r&&(k.isZeronet=r),k.activeProvider=e},resetProvider:function(){k.activeProvider="http://127.0.0.1:8732"},query:function(e,r,t){return void 0===r?void 0===t?t="GET":r={}:void 0===t&&(t="POST"),new Promise(function(n,i){try{var o=new c;o.open(t,k.activeProvider+e,k.async),o.onload=function(){if(k.debugMode&&console.log(e,r,o.responseText),200===o.status)if(o.responseText){var t=JSON.parse(o.responseText);void 0!==t.error?i(t.error):(void 0!==t.ok&&(t=t.ok),n(t))}else i("Empty response returned");else o.responseText?i(o.responseText):i(o.statusText)},o.onerror=function(){i(o.statusText)},"POST"===t?(o.setRequestHeader("Content-Type","application/json"),o.send(JSON.stringify(r))):o.send()}catch(e){i(e)}})}},w={getAddress:function(){var e=a(regeneratorRuntime.mark(function e(r){var t,n,i,o,a,c,s,u,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.path,n=void 0===t?"44'/1729'/0'/0'":t,i=r.displayConfirm,o=void 0!==i&&i,a=r.curve,c=void 0===a?0:a,e.next=3,l.create();case 3:return s=e.sent,u=new h(s),e.next=7,u.getAddress(n,o,c);case 7:return d=e.sent,s.close(),e.abrupt("return",d);case 10:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),signOperation:function(){var e=a(regeneratorRuntime.mark(function e(r){var t,n,i,o,a,c,s,u,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.path,n=void 0===t?"44'/1729'/0'/0'":t,i=r.rawTxHex,o=r.curve,a=void 0===o?0:o,e.next=3,l.create();case 3:return c=e.sent,s=new h(c),e.next=7,s.signOperation(n,"03".concat(i),a);case 7:return u=e.sent,d=u.signature,c.close(),e.abrupt("return",{signature:d});case 11:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),getVersion:function(){var e=a(regeneratorRuntime.mark(function e(){var r,t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.create();case 2:return r=e.sent,t=new h(r),e.next=6,t.getVersion();case 6:return n=e.sent,r.close(),e.abrupt("return",n);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},x={account:function(){var e=a(regeneratorRuntime.mark(function e(r){var t,n,i,o,a,c,s,u,d,f,p,l,h,g,v,m,b,_,A,P,O,U,j=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.keys,n=r.amount,i=r.spendable,o=r.delegatable,a=r.delegate,c=r.fee,s=void 0===c?"1278":c,u=r.gasLimit,d=void 0===u?"10000":u,f=r.storageLimit,p=void 0===f?"257":f,l=j.length>1&&void 0!==j[1]?j[1]:{},h=l.useLedger,g=void 0!==h&&h,v=l.path,m=void 0===v?"44'/1729'/0'/0'":v,b=l.curve,_=void 0===b?0:b,A=t&&t.pkh,!g){e.next=9;break}return e.next=6,w.getAddress({path:m,curve:_});case 6:P=e.sent,O=P.address,A=O;case 9:return U={kind:"origination",balance:"".concat(y.mutez(n)),fee:"".concat(s),gas_limit:d,storage_limit:p},k.isZeronet?U.manager_pubkey=A:U.managerPubkey=A,void 0!==i&&(U.spendable=i),void 0!==o&&(U.delegatable=o),void 0!==a&&a&&(U.delegate=a),e.abrupt("return",x.sendOperation({from:A,operation:U,keys:t},{useLedger:g,path:m,curve:_}));case 15:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),getBalance:function(e){return k.query("/chains/main/blocks/head/context/contracts/".concat(e,"/balance")).then(function(e){return e})},getDelegate:function(e){return k.query("/chains/main/blocks/head/context/contracts/".concat(e,"/delegate")).then(function(e){return e||!1}).catch(function(){return!1})},getHead:function(){return k.query("/chains/main/blocks/head")},getHeadHash:function(){return k.query("/chains/main/blocks/head/hash")},call:function(e,r){return k.query(e,r)},sendOperation:function(e){var r,t,o,c,s=e.from,u=e.operation,d=e.keys,f=void 0!==d&&d,p=e.skipPrevalidation,l=void 0!==p&&p,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},v=h.useLedger,y=void 0!==v&&v,_=h.path,A=void 0===_?"44'/1729'/0'/0'":_,P=h.curve,O=void 0===P?0:P,U=[],j=!1,L=[];U.push(k.query("/chains/main/blocks/head/header")),L=Array.isArray(u)?i(u):[u];for(var S=0;S<L.length;S++)if(["transaction","origination","delegation"].includes(L[S].kind)){j=!0,U.push(k.query("/chains/main/blocks/head/context/contracts/".concat(s,"/counter"))),U.push(k.query("/chains/main/blocks/head/context/contracts/".concat(s,"/manager_key")));break}return Promise.all(U).then(function(){var e=a(regeneratorRuntime.mark(function e(t){var i,a,u,d,p,l,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(t,3),a=i[0],u=i[1],d=i[2],c=a,!j||!f&&!y||void 0!==d.key){e.next=9;break}if(!y){e.next=8;break}return e.next=6,w.getAddress({path:A,curve:O});case 6:l=e.sent,p=l.publicKey;case 8:L.unshift({kind:"reveal",fee:k.isZeronet?"100000":"1269",public_key:p||f.pk,source:s,gas_limit:"10000",storage_limit:"0"});case 9:return r=parseInt(u,10),g[s]=r,h=function(){return L.map(function(e){return["proposals","ballot","transaction","origination","delegation"].includes(e.kind)&&void 0===e.source&&(e.source=s),["reveal","transaction","origination","delegation"].includes(e.kind)&&(void 0===e.gas_limit&&(e.gas_limit="0"),void 0===e.storage_limit&&(e.storage_limit="0"),e.counter="".concat(++g[s]),e.fee="".concat(e.fee),e.gas_limit="".concat(e.gas_limit),e.storage_limit="".concat(e.storage_limit)),JSON.stringify(e)}).map(function(e){return JSON.parse(e)})},o={branch:c.hash,contents:h()},e.abrupt("return",k.query("/chains/".concat(c.chain_id,"/blocks/").concat(c.hash,"/helpers/forge/operations"),o));case 14:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=a(regeneratorRuntime.mark(function e(r){var n,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!y){e.next=8;break}return e.next=3,w.signOperation({path:A,rawTxHex:r,curve:O});case 3:n=e.sent,i=n.signature,t="".concat(r).concat(i),e.next=14;break;case 8:if(!1!==f.sk){e.next=13;break}return o.protocol=c.protocol,e.abrupt("return",{opOb:o,opbytes:r});case 13:f?(a=b.sign(r,f.sk,m.generic),t=a.sbytes,o.signature=a.edsig):(t="".concat(r,"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),o.signature="edsigtXomBKi5CTRf5cjATJWSyaRvhfYNHqSUGrn4SdbYRcGwQrUGjzEfQDTuqHhuA8b2d8NarZjz8TRf65WkpQmo423BtomS8Q");case 14:if(o.protocol=c.protocol,!l&&!y){e.next=17;break}return e.abrupt("return",x.silentInject(t));case 17:return e.abrupt("return",x.inject(o,t));case 18:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}())},inject:function(e,r){var t=[],n=[];return k.query("/chains/main/blocks/head/helpers/preapply/operations",[e]).then(function(e){if(!Array.isArray(e))throw new Error({error:"RPC Fail",errors:[]});for(var i=0;i<e.length;i++)for(var o=0;o<e[i].contents.length;o++)t.push(e[i].contents[o]),void 0!==e[i].contents[o].metadata.operation_result&&"failed"===e[i].contents[o].metadata.operation_result.status&&(n=n.concat(e[i].contents[o].metadata.operation_result.errors));if(n.length)throw new Error({error:"Operation Failed",errors:n});return k.query("/injection/operation",r)}).then(function(e){return{hash:e,operations:t}})},silentInject:function(e){return k.query("/injection/operation",e).then(function(e){return{hash:e}})},transfer:function(e){var r=e.from,t=e.keys,n=e.to,i=e.amount,o=e.fee,a=void 0===o?"1278":o,c=e.parameter,s=void 0!==c&&c,u=e.gasLimit,d=void 0===u?"10100":u,f=e.storageLimit,p=void 0===f?"0":f,l=e.mutez,h=void 0!==l&&l,g=e.rawParam,v=void 0!==g&&g,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},b=m.useLedger,k=void 0!==b&&b,w=m.path,_=void 0===w?"44'/1729'/0'/0'":w,A=m.curve,P=void 0===A?0:A,O={kind:"transaction",fee:"".concat(a),gas_limit:d,storage_limit:p,amount:h?i:"".concat(y.mutez(i)),destination:n};return s&&(O.parameters=v?s:y.sexp2mic(s)),x.sendOperation({from:r,operation:O,keys:t},{useLedger:k,path:_,curve:P})},activate:function(e,r){var t={kind:"activate_account",pkh:e.pkh,secret:r};return x.sendOperation({from:e.pkh,operation:t,keys:e})},originate:function(){var e=a(regeneratorRuntime.mark(function e(r){var t,n,i,o,a,c,s,u,d,f,p,l,h,g,v,m,b,_,A,P,O,U,j,L,S,q,T,z,B=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.keys,n=r.amount,i=r.code,o=r.init,a=r.spendable,c=void 0!==a&&a,s=r.delegatable,u=void 0!==s&&s,d=r.delegate,f=r.fee,p=void 0===f?"1278":f,l=r.gasLimit,h=void 0===l?"10000":l,g=r.storageLimit,v=void 0===g?"257":g,m=B.length>1&&void 0!==B[1]?B[1]:{},b=m.useLedger,_=void 0!==b&&b,A=m.path,P=void 0===A?"44'/1729'/0'/0'":A,O=m.curve,U=void 0===O?0:O,j=y.ml2mic(i),L={code:j,storage:y.sexp2mic(o)},S=t&&t.pkh,!_){e.next=11;break}return e.next=8,w.getAddress({path:P,curve:U});case 8:q=e.sent,T=q.address,S=T;case 11:return z={kind:"origination",fee:"".concat(p),storage_limit:v,gas_limit:h,balance:"".concat(y.mutez(n)),spendable:c,delegatable:u,delegate:void 0!==d&&d?d:S,script:L},k.isZeronet?z.manager_pubkey=S:z.managerPubkey=S,e.abrupt("return",x.sendOperation({from:S,operation:z,keys:t},{useLedger:_,path:P,curve:U}));case 14:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),setDelegate:function(){var e=a(regeneratorRuntime.mark(function e(r){var t,n,i,o,a,c,s,u,d,f,p,l,h,g,v,m,y,b,k,_,A=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.from,n=r.keys,i=r.delegate,o=r.fee,a=void 0===o?"1278":o,c=r.gasLimit,s=void 0===c?"10000":c,u=r.storageLimit,d=void 0===u?"0":u,f=A.length>1&&void 0!==A[1]?A[1]:{},p=f.useLedger,l=void 0!==p&&p,h=f.path,g=void 0===h?"44'/1729'/0'/0'":h,v=f.curve,m=void 0===v?0:v,y=n&&n.pkh,!l){e.next=9;break}return e.next=6,w.getAddress({path:g,curve:m});case 6:b=e.sent,k=b.address,y=k;case 9:return _={kind:"delegation",fee:"".concat(a),gas_limit:s,storage_limit:d,delegate:void 0!==i?i:y},e.abrupt("return",x.sendOperation({from:t,operation:_,keys:n},{useLedger:l,path:g,curve:m}));case 11:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),registerDelegate:function(){var e=a(regeneratorRuntime.mark(function e(r){var t,n,i,o,a,c,s,u,d,f,p,l,h,g,v,m,y,b,k=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.keys,n=r.fee,i=void 0===n?"1278":n,o=r.gasLimit,a=void 0===o?"10000":o,c=r.storageLimit,s=void 0===c?"0":c,u=k.length>1&&void 0!==k[1]?k[1]:{},d=u.useLedger,f=void 0!==d&&d,p=u.path,l=void 0===p?"44'/1729'/0'/0'":p,h=u.curve,g=void 0===h?0:h,v=t&&t.pkh,!f){e.next=9;break}return e.next=6,w.getAddress({path:l,curve:g});case 6:m=e.sent,y=m.address,v=y;case 9:return b={kind:"delegation",fee:"".concat(i),gas_limit:a,storage_limit:s,delegate:v},e.abrupt("return",x.sendOperation({from:v,operation:b,keys:t},{useLedger:f,path:l,curve:g}));case 11:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),typecheckCode:function(e){var r=y.ml2mic(e);return k.query("/chains/main/blocks/head/helpers/scripts/typecheck_code",{program:r,gas:"10000"})},packData:function(e,r){var t={data:y.sexp2mic(e),type:y.sexp2mic(r),gas:"4000000"};return k.query("/chains/main/blocks/head/helpers/scripts/pack_data",t)},typecheckData:function(e,r){var t={data:y.sexp2mic(e),type:y.sexp2mic(r),gas:"4000000"};return k.query("/chains/main/blocks/head/helpers/scripts/typecheck_data",t)},runCode:function(e,r,t,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4]?"trace_code":"run_code";return k.query("/chains/main/blocks/head/helpers/scripts/".concat(i),{script:y.ml2mic(e),amount:"".concat(y.mutez(r)),input:y.sexp2mic(t),storage:y.sexp2mic(n)})}},_={hash:function(e,r){for(var t=y.b58cdecode(e,v.o),n=[],i=0;i<t.length;i++)n.push(t[i]);return n=n.concat([(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r]),y.b58cencode(u.crypto_generichash(20,new Uint8Array(n)),v.KT)},originate:function(e){var r=e.keys,t=e.amount,n=e.code,i=e.init,o=e.spendable,a=e.delegatable,c=e.delegate,s=e.fee,u=void 0===s?"1278":s,d=e.gasLimit,f=void 0===d?"10000":d,p=e.storageLimit,l=void 0===p?"10000":p;return x.originate({keys:r,amount:t,code:n,init:i,spendable:o,delegatable:a,delegate:c,fee:u,gasLimit:f,storageLimit:l})},storage:function(e){return new Promise(function(r,t){return k.query("/chains/main/blocks/head/context/contracts/".concat(e,"/storage")).then(function(e){return r(e)}).catch(function(e){return t(e)})})},load:function(e){return k.query("/chains/main/blocks/head/context/contracts/".concat(e))},watch:function(e,r,t){var n=[],i=function(){_.storage(e).then(function(e){JSON.stringify(n)!==JSON.stringify(e)&&t(n=e)})};return i(),setInterval(i,1e3*r)},send:function(e){var r=e.to,t=e.from,n=e.keys,i=e.amount,o=e.parameter,a=e.fee,c=void 0===a?"1278":a,s=e.gasLimit,u=void 0===s?"2000":s,d=e.storageLimit,f=void 0===d?"0":d,p=e.mutez,l=void 0!==p&&p,h=e.rawParam,g=void 0!==h&&h,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=v.useLedger,y=void 0!==m&&m,b=v.path,k=void 0===b?"44'/1729'/0'/0'":b,w=v.curve,_=void 0===w?0:w;return x.transfer({from:t,keys:n,to:r,amount:i,fee:c,parameter:o,gasLimit:u,storageLimit:f,mutez:l,rawParam:g},{useLedger:y,path:k,curve:_})}};y.ml2tzjson=y.sexp2mic,y.tzjson2arr=y.mic2arr,y.mlraw2json=y.ml2mic,y.mintotz=y.totez,y.tztomin=y.mutez,v.TZ=new Uint8Array([2,90,121]);var A={utility:y,crypto:b,node:k,rpc:x,contract:_,ledger:w};e.exports=A},function(e,r){e.exports=require("xhr2")},function(e,r){e.exports=require("libsodium-wrappers")},function(e,r){e.exports=require("bip39")},function(e,r){e.exports=require("pbkdf2")},function(e,r){e.exports=require("bignumber.js")},function(e,r){e.exports=require("@ledgerhq/hw-transport-node-hid")},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),i=t(11);var o=function(){function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.transport=r,r.decorateAppAPIMethods(this,["getAddress","signOperation","getVersion"],"XTZ")}return n(e,[{key:"getAddress",value:function(e,r,t,n){n||(n=r?3:2);var o=(0,i.splitPath)(e);t=t||0;var a=new Buffer(1+4*o.length);return a[0]=o.length,o.forEach(function(e,r){a.writeUInt32BE(e,1+4*r)}),this.transport.send(128,n,0,t,a).then(function(e){var r=e[0],n=e.slice(1,1+r);return(0,i.encodePublicKey)(n,t)})}},{key:"signOperation",value:function(e,r,t){var n=this,o=(0,i.splitPath)(e),a=0,c=new Buffer(r,"hex"),s=[],u=void 0;t=t||0;var d=new Buffer(4*o.length+1);for(d[0]=o.length,o.forEach(function(e,r){d.writeUInt32BE(e,1+4*r)}),s.push(d);a!==c.length;){var f=void 0;f=a+255>=c.length?c.length-a:255;var p=new Buffer(f);c.copy(p,0,a,a+f),s.push(p),a+=f}return(0,i.foreach)(s,function(e,r){var i=1;return 0===r?i=0:r===s.length-1&&(i=129),n.transport.send(128,4,i,t,e).then(function(e){u=e})}).then(function(){return{signature:u.slice(0,u.length-2).toString("hex")}})}},{key:"getVersion",value:function(){return this.transport.send(128,0,0,0,new Buffer(0)).then(function(e){var r=1==e[0];return{major:e[1],minor:e[2],patch:e[3],bakingApp:r}})}}]),e}();r.default=o},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.encodePublicKey=void 0,r.defer=function(){var e=void 0,r=void 0,t=new Promise(function(t,n){e=t,r=n});if(!e||!r)throw"defer() error";return{promise:t,resolve:e,reject:r}},r.splitPath=function(e){var r=[];return e.split("/").forEach(function(e){var t=parseInt(e,10);isNaN(t)||(e.length>1&&"'"===e[e.length-1]&&(t+=2147483648),r.push(t))}),r},r.eachSeries=function(e,r){return e.reduce(function(e,t){return e.then(function(){return r(t)})},Promise.resolve())},r.foreach=function(e,r){return Promise.resolve().then(function(){return function e(t,n,i){return t>=n.length?i:r(n[t],t).then(function(r){return i.push(r),e(t+1,n,i)})}(0,e,[])})},r.doIf=function(e,r){return Promise.resolve().then(function(){if(e)return r()})},r.asyncWhile=function(e,r){return Promise.resolve([]).then(function t(n){return e()?r().then(function(e){return n.push(e),t(n)}):n})};var n=o(t(0)),i=o(t(12));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){switch(e){case 0:return Buffer.of(13,15,37,217);case 1:return Buffer.of(3,254,226,86);case 2:return Buffer.of(3,178,139,127)}},c=function(e){switch(e){case 0:return Buffer.of(6,161,159);case 1:return Buffer.of(6,161,161);case 2:return Buffer.of(6,161,164)}},s=(r.encodePublicKey=function(e,r){return e=function(e,r){switch(r){case 0:return(e=e.slice(0))[0]=r,e;case 1:case 2:return Buffer.concat([Buffer.of(r,2+(1&e[64])),e.slice(1,33)])}}(e,r),{publicKey:s(e),address:u(e)}},function(e){var r=e[0],t=e.slice(1);return n.default.encode(Buffer.concat([a(r),t]))}),u=function(e){var r=e[0],t=e.slice(1),o=(0,i.default)(20);return o.update(t),o.digest(o=new Buffer(20)),n.default.encode(Buffer.concat([c(r),o]))}},function(e,r){e.exports=require("blake2b")}])});